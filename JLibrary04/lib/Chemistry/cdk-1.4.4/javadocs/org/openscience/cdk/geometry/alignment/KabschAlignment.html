<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_23) on Tue Sep 27 17:53:49 CEST 2011 -->
<TITLE>
KabschAlignment (CDK API - version 20110927)
</TITLE>

<META NAME="date" CONTENT="2011-09-27">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="KabschAlignment (CDK API - version 20110927)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/KabschAlignment.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?org/openscience/cdk/geometry/alignment/KabschAlignment.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="KabschAlignment.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.openscience.cdk.geometry.alignment</FONT>
<BR>
Class KabschAlignment</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../../resources/inherit.gif" ALT="extended by "><B>org.openscience.cdk.geometry.alignment.KabschAlignment</B>
</PRE>
<HR>
<DL>
<DT><PRE><FONT SIZE="-1"><A HREF="../../../../../org/openscience/cdk/annotations/TestClass.html" title="annotation in org.openscience.cdk.annotations">@TestClass</A>(<A HREF="../../../../../org/openscience/cdk/annotations/TestClass.html#value()">value</A>="org.openscience.cdk.geometry.alignment.KabschAlignmentTest")
</FONT>public class <B>KabschAlignment</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
Aligns two structures to minimize the RMSD using the Kabsch algorithm.

 <p>This class is an implementation of the Kabsch algorithm ([<!-- indexOf-1 -->Kabsch, W., <i>A Solution for the Best Rotation to Relate Two Sets of Vectors</i>, Acta Cryst., <b>1976</b>, A32:922-923], [<!-- indexOf-1 -->Kabsch, W., <i>Discussion of Solution for Best Rotation to Relate 2 Sets of Vectors</i>, Acta Cryst., <b>1978</b>, A34:827-828])
 and evaluates the optimal rotation matrix (U) to minimize the RMSD between the two structures.
 Since the algorithm assumes that the number of points are the same in the two structures
 it is the job of the caller to pass the proper number of atoms from the two structures. Constructors
 which take whole <code>AtomContainer</code>'s are provided but they should have the same number
 of atoms.
 The algorithm allows for the use of atom weightings and by default all points are given a weight of 1.0

 <p>Example usage can be:
 <pre>
 AtomContainer ac1, ac2;

 try {
    KabschAlignment sa = new KabschAlignment(ac1.getAtoms(),ac2.getAtoms());
    sa.align();
    System.out.println(sa.getRMSD());
 } catch (CDKException e){}
 </pre>
 In many cases, molecules will be aligned based on some common substructure.
 In this case the center of masses calculated during alignment refer to these
 substructures rather than the whole molecules. To superimpose the molecules
 for display, the second molecule must be rotated and translated by calling
 <code>rotateAtomContainer</code>. However, since this will also translate the
 second molecule, the first molecule should also be translated to the center of mass
 of the substructure specifed for this molecule. This center of mass can be obtained
 by a call to <code>getCenterOfMass</code> and then manually translating the coordinates.
 Thus an example would be
 <pre>
 AtomContainer ac1, ac2;  // whole molecules
 Atom[] a1, a2;           // some subset of atoms from the two molecules
 KabschAlignment sa;
 
 try {
    sa = new KabschAlignment(a1,a2);
    sa.align();
 } catch (CDKException e){}

 Point3d cm1 = sa.getCenterOfMass();
 for (int i = 0; i &lt; ac1.getAtomCount(); i++) {
    Atom a = ac1.getAtomAt(i);
    a.setX3d( a.getPoint3d().x - cm1.x );
    a.setY3d( a.getPoint3d().y - cm1.y );
    a.setY3d( a.getPoint3d().z - cm1.z );
 }
 sa.rotateAtomContainer(ac2);

 // display the two AtomContainer's
</pre>
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>Rajarshi Guha</DD>
<DT><B>Created on:</B></DT>
  <DD>2004-12-11</DD>
<DT><B>Required library to be able to run this class:</B></DT>
  <DD>Jama-1.0.1.jar</DD>
<DT><B>Required library to be able to compile this class:</B></DT>
  <DD>Jama-1.0.1.jar</DD>
<DT><B>Dictionary pointer(s): </B><DD><a href="http://qsar.sourceforge.net/dicts/blue-obelisk/index.xhtml#alignmentKabsch">alignmentKabsch</a> in the <a href="http://qsar.sourceforge.net/dicts/blue-obelisk/index.xhtml">Blue Obelisk Chemoinformatics Dictionary</a> [blue-obelisk:alignmentKabsch]</DD>
<DT><B>Source code: </B><DD><a href="https://github.com/cdk/cdk/tree/cdk-1.4.x/src/main/org/openscience/cdk" target="_blank">cdk-1.4.x</a></DD>
</DL>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../org/openscience/cdk/geometry/alignment/KabschAlignment.html#KabschAlignment(org.openscience.cdk.Atom[], org.openscience.cdk.Atom[])">KabschAlignment</A></B>(<A HREF="../../../../../org/openscience/cdk/Atom.html" title="class in org.openscience.cdk">Atom</A>[]&nbsp;al1,
                <A HREF="../../../../../org/openscience/cdk/Atom.html" title="class in org.openscience.cdk">Atom</A>[]&nbsp;al2)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets up variables for the alignment algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../org/openscience/cdk/geometry/alignment/KabschAlignment.html#KabschAlignment(org.openscience.cdk.Atom[], org.openscience.cdk.Atom[], double[])">KabschAlignment</A></B>(<A HREF="../../../../../org/openscience/cdk/Atom.html" title="class in org.openscience.cdk">Atom</A>[]&nbsp;al1,
                <A HREF="../../../../../org/openscience/cdk/Atom.html" title="class in org.openscience.cdk">Atom</A>[]&nbsp;al2,
                double[]&nbsp;wts)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets up variables for the alignment algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../org/openscience/cdk/geometry/alignment/KabschAlignment.html#KabschAlignment(org.openscience.cdk.interfaces.IAtomContainer, org.openscience.cdk.interfaces.IAtomContainer)">KabschAlignment</A></B>(<A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</A>&nbsp;ac1,
                <A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</A>&nbsp;ac2)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets up variables for the alignment algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../org/openscience/cdk/geometry/alignment/KabschAlignment.html#KabschAlignment(org.openscience.cdk.interfaces.IAtomContainer, org.openscience.cdk.interfaces.IAtomContainer, double[])">KabschAlignment</A></B>(<A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</A>&nbsp;ac1,
                <A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</A>&nbsp;ac2,
                double[]&nbsp;wts)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets up variables for the alignment algorithm.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/openscience/cdk/geometry/alignment/KabschAlignment.html#align()">align</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Perform an alignment.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.vecmath.Point3d</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/openscience/cdk/geometry/alignment/KabschAlignment.html#getCenterOfMass()">getCenterOfMass</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the center of mass for the first molecule or fragment used in the calculation.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/openscience/cdk/geometry/alignment/KabschAlignment.html#getRMSD()">getRMSD</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the RMSD from the alignment.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;double[][]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/openscience/cdk/geometry/alignment/KabschAlignment.html#getRotationMatrix()">getRotationMatrix</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the rotation matrix (u).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/openscience/cdk/geometry/alignment/KabschAlignment.html#rotateAtomContainer(org.openscience.cdk.interfaces.IAtomContainer)">rotateAtomContainer</A></B>(<A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</A>&nbsp;ac)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rotates the <A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces"><CODE>IAtomContainer</CODE></A> coordinates by the rotation matrix.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="KabschAlignment(org.openscience.cdk.Atom[], org.openscience.cdk.Atom[])"><!-- --></A><H3>
KabschAlignment</H3>
<PRE>
public <B>KabschAlignment</B>(<A HREF="../../../../../org/openscience/cdk/Atom.html" title="class in org.openscience.cdk">Atom</A>[]&nbsp;al1,
                       <A HREF="../../../../../org/openscience/cdk/Atom.html" title="class in org.openscience.cdk">Atom</A>[]&nbsp;al2)
                throws <A HREF="../../../../../org/openscience/cdk/exception/CDKException.html" title="class in org.openscience.cdk.exception">CDKException</A></PRE>
<DL>
<DD>Sets up variables for the alignment algorithm.

 The algorithm allows for atom weighting and the default is 1.0 for all
 atoms.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>al1</CODE> - An array of <A HREF="../../../../../org/openscience/cdk/Atom.html" title="class in org.openscience.cdk"><CODE>Atom</CODE></A> objects<DD><CODE>al2</CODE> - An array of <A HREF="../../../../../org/openscience/cdk/Atom.html" title="class in org.openscience.cdk"><CODE>Atom</CODE></A> objects. This array will have its coordinates rotated
            so that the RMDS is minimzed to the coordinates of the first array
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/openscience/cdk/exception/CDKException.html" title="class in org.openscience.cdk.exception">CDKException</A></CODE> - if the number of Atom's are not the same in the two arrays</DL>
</DL>
<HR>

<A NAME="KabschAlignment(org.openscience.cdk.Atom[], org.openscience.cdk.Atom[], double[])"><!-- --></A><H3>
KabschAlignment</H3>
<PRE>
public <B>KabschAlignment</B>(<A HREF="../../../../../org/openscience/cdk/Atom.html" title="class in org.openscience.cdk">Atom</A>[]&nbsp;al1,
                       <A HREF="../../../../../org/openscience/cdk/Atom.html" title="class in org.openscience.cdk">Atom</A>[]&nbsp;al2,
                       double[]&nbsp;wts)
                throws <A HREF="../../../../../org/openscience/cdk/exception/CDKException.html" title="class in org.openscience.cdk.exception">CDKException</A></PRE>
<DL>
<DD>Sets up variables for the alignment algorithm.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>al1</CODE> - An array of <A HREF="../../../../../org/openscience/cdk/Atom.html" title="class in org.openscience.cdk"><CODE>Atom</CODE></A> objects<DD><CODE>al2</CODE> - An array of <A HREF="../../../../../org/openscience/cdk/Atom.html" title="class in org.openscience.cdk"><CODE>Atom</CODE></A> objects. This array will have its coordinates rotated
            so that the RMDS is minimzed to the coordinates of the first array<DD><CODE>wts</CODE> - A vector atom weights.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/openscience/cdk/exception/CDKException.html" title="class in org.openscience.cdk.exception">CDKException</A></CODE> - if the number of Atom's are not the same in the two arrays or
                         length of the weight vector is not the same as the Atom arrays</DL>
</DL>
<HR>

<A NAME="KabschAlignment(org.openscience.cdk.interfaces.IAtomContainer, org.openscience.cdk.interfaces.IAtomContainer)"><!-- --></A><H3>
KabschAlignment</H3>
<PRE>
<FONT SIZE="-1"><A HREF="../../../../../org/openscience/cdk/annotations/TestMethod.html" title="annotation in org.openscience.cdk.annotations">@TestMethod</A>(<A HREF="../../../../../org/openscience/cdk/annotations/TestMethod.html#value()">value</A>="testAlign")
</FONT>public <B>KabschAlignment</B>(<A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</A>&nbsp;ac1,
                                       <A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</A>&nbsp;ac2)
                throws <A HREF="../../../../../org/openscience/cdk/exception/CDKException.html" title="class in org.openscience.cdk.exception">CDKException</A></PRE>
<DL>
<DD>Sets up variables for the alignment algorithm.

 The algorithm allows for atom weighting and the default is 1.0 for all
 atoms.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>ac1</CODE> - An <A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces"><CODE>IAtomContainer</CODE></A><DD><CODE>ac2</CODE> - An <A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces"><CODE>IAtomContainer</CODE></A>. This AtomContainer will have its coordinates rotated
            so that the RMDS is minimzed to the coordinates of the first one
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/openscience/cdk/exception/CDKException.html" title="class in org.openscience.cdk.exception">CDKException</A></CODE> - if the number of atom's are not the same in the two AtomContainer's</DL>
</DL>
<HR>

<A NAME="KabschAlignment(org.openscience.cdk.interfaces.IAtomContainer, org.openscience.cdk.interfaces.IAtomContainer, double[])"><!-- --></A><H3>
KabschAlignment</H3>
<PRE>
public <B>KabschAlignment</B>(<A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</A>&nbsp;ac1,
                       <A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</A>&nbsp;ac2,
                       double[]&nbsp;wts)
                throws <A HREF="../../../../../org/openscience/cdk/exception/CDKException.html" title="class in org.openscience.cdk.exception">CDKException</A></PRE>
<DL>
<DD>Sets up variables for the alignment algorithm.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>ac1</CODE> - An <A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces"><CODE>IAtomContainer</CODE></A><DD><CODE>ac2</CODE> - An <A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces"><CODE>IAtomContainer</CODE></A>. This AtomContainer will have its coordinates rotated
            so that the RMDS is minimzed to the coordinates of the first one<DD><CODE>wts</CODE> - A vector atom weights.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/openscience/cdk/exception/CDKException.html" title="class in org.openscience.cdk.exception">CDKException</A></CODE> - if the number of atom's are not the same in the two AtomContainer's or
                         length of the weight vector is not the same as number of atoms.</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="align()"><!-- --></A><H3>
align</H3>
<PRE>
<FONT SIZE="-1"><A HREF="../../../../../org/openscience/cdk/annotations/TestMethod.html" title="annotation in org.openscience.cdk.annotations">@TestMethod</A>(<A HREF="../../../../../org/openscience/cdk/annotations/TestMethod.html#value()">value</A>="testAlign")
</FONT>public void <B>align</B>()</PRE>
<DL>
<DD>Perform an alignment.

 This method aligns to set of atoms which should have been specified
 prior to this call
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getRMSD()"><!-- --></A><H3>
getRMSD</H3>
<PRE>
<FONT SIZE="-1"><A HREF="../../../../../org/openscience/cdk/annotations/TestMethod.html" title="annotation in org.openscience.cdk.annotations">@TestMethod</A>(<A HREF="../../../../../org/openscience/cdk/annotations/TestMethod.html#value()">value</A>="testAlign")
</FONT>public double <B>getRMSD</B>()</PRE>
<DL>
<DD>Returns the RMSD from the alignment.

 If align() has not been called the return value is -1.0
<P>
<DD><DL>

<DT><B>Returns:</B><DD>The RMSD for this alignment<DT><B>See Also:</B><DD><A HREF="../../../../../org/openscience/cdk/geometry/alignment/KabschAlignment.html#align()"><CODE>align()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getRotationMatrix()"><!-- --></A><H3>
getRotationMatrix</H3>
<PRE>
<FONT SIZE="-1"><A HREF="../../../../../org/openscience/cdk/annotations/TestMethod.html" title="annotation in org.openscience.cdk.annotations">@TestMethod</A>(<A HREF="../../../../../org/openscience/cdk/annotations/TestMethod.html#value()">value</A>="testAlign")
</FONT>public double[][] <B>getRotationMatrix</B>()</PRE>
<DL>
<DD>Returns the rotation matrix (u).
<P>
<DD><DL>

<DT><B>Returns:</B><DD>A double[][] representing the rotation matrix<DT><B>See Also:</B><DD><A HREF="../../../../../org/openscience/cdk/geometry/alignment/KabschAlignment.html#align()"><CODE>align()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getCenterOfMass()"><!-- --></A><H3>
getCenterOfMass</H3>
<PRE>
public javax.vecmath.Point3d <B>getCenterOfMass</B>()</PRE>
<DL>
<DD>Returns the center of mass for the first molecule or fragment used in the calculation.

 This method is useful when using this class to align the coordinates
 of two molecules and them displaying them superimposed. Since the center of
 mass used during the alignment may not be based on the whole molecule (in 
 general common substructures are aligned), when preparing molecules for display
 the first molecule should be translated to the center of mass. Then displaying the
 first molecule and the rotated version of the second one will result in superimposed
 structures.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>A Point3d containing the coordinates of the center of mass</DL>
</DD>
</DL>
<HR>

<A NAME="rotateAtomContainer(org.openscience.cdk.interfaces.IAtomContainer)"><!-- --></A><H3>
rotateAtomContainer</H3>
<PRE>
public void <B>rotateAtomContainer</B>(<A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</A>&nbsp;ac)</PRE>
<DL>
<DD>Rotates the <A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces"><CODE>IAtomContainer</CODE></A> coordinates by the rotation matrix.

 In general if you align a subset of atoms in a AtomContainer
 this function can be applied to the whole AtomContainer to rotate all
 atoms. This should be called with the second AtomContainer (or Atom[])
 that was passed to the constructor.

 Note that the AtomContainer coordinates also get translated such that the
 center of mass of the original fragment used to calculate the alignment is at the origin.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>ac</CODE> - The <A HREF="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces"><CODE>IAtomContainer</CODE></A> whose coordinates are to be rotated</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/KabschAlignment.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?org/openscience/cdk/geometry/alignment/KabschAlignment.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="KabschAlignment.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
